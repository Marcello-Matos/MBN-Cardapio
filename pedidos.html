<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

    <link rel="icon" href="assets/logo.svg" type="favicon">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
    <link href="./styles/output.css" rel="stylesheet" />

    <title>Pedidos Recebidos</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
  <script type="module">
    // Importando as funções necessárias do Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.16.0/firebase-app.js"; // Para inicializar o Firebase
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.16.0/firebase-firestore.js"; // Para acessar o Firestore

    // Configuração do Firebase (substitua com suas próprias credenciais)
    const firebaseConfig = {
        apiKey: "AIzaSyDvnrGRrLGUBFKp8xh9ngQn1uKn9QUGq6s",
        authDomain: "cardapio-mbn.firebaseapp.com",
        projectId: "cardapio-mbn",
        storageBucket: "cardapio-mbn.firebasestorage.app",
        messagingSenderId: "688708152488",
        appId: "1:688708152488:web:1e12adcc98ba90046c669d"
    };

    // Inicializando o Firebase
    const app = initializeApp(firebaseConfig);

    // Inicializando o Firestore
    const db = getFirestore(app);

    // Função para buscar pedidos
    async function buscarPedidos() {
      try {
        // Referência à coleção "pedidos"
        const pedidosRef = collection(db, "pedidos");

        // Obtendo os documentos
        const querySnapshot = await getDocs(pedidosRef);

        // Limpa o contêiner antes de adicionar os dados
        const pedidosContainer = document.getElementById('pedidos-container');
        pedidosContainer.innerHTML = ''; 

        // Itera sobre os documentos e cria os elementos HTML
        querySnapshot.forEach((doc) => {
          const pedido = doc.data();
          const pedidoDiv = document.createElement('div');
          pedidoDiv.innerHTML = `
          
          <div>
            <p><strong>Pedido:</strong></p>
            <ul>
              ${pedido.pedido.pedido.map(item => `
                <li>${JSON.stringify(item.name)} Quantidade: ${JSON.stringify(item.quantity)}
                </li>
              `).join('')}
            </ul>
            <div>
            <p><strong>Mesa:</strong> ${pedido.pedido.mesa}</p>
          </div>
          </div>
          <p><strong>Data:</strong> ${pedido.pedido.datadeagora}</p>
          `;
          pedidosContainer.appendChild(pedidoDiv);
        });
      } catch (error) {
        console.error("Erro ao buscar os pedidos:", error);
      }
    }

    // Chama a função de busca assim que a página for carregada
    document.addEventListener('DOMContentLoaded', function() {
      buscarPedidos();
    });
  </script>
    <!-- HEADER -->
    <header class="w-full h-[420px] bg-home bg-cover bg-center">
        <div class="w-full h-full text-center text-white flex flex-col justify-center items-center">
        </div>
    </header>
    <!-- HEADER END -->

    <h2 class="text-2xl md:text-3xl font-bold text-center mt-9 mb-6">Pedidos Recebidos</h2>

    <!-- INÍCIO SEÇÃO DE PEDIDOS -->
    <div id="pedidos" class="max-w-7xl mx-auto px-4 mb-16">
        <div id="pedidos-container" class="bg-white shadow-md rounded-lg p-4">
            
        </div>
    </div>
    <!-- FIM SEÇÃO DE PEDIDOS -->

    <!-- START BUTTOON CART FOOTER -->
    <footer class="w-full bg-red-500 py-3 fixed bottom-0 z-40 flex items justify-center">
        <a class="flex items-center gap-2 text-white font-bold" href="index.html">
            Voltar ao Menu
            <i class="fa fa-arrow-left text-lg text-white"></i>
        </a>
    </footer>
    <!-- BUTTOON CART FOOTER END -->
</body>
</html>